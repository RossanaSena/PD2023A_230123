packages:
  yum:
    mod24_ssl : []

files:
  /etc/httpd/conf.d/ssl.conf:
    mode: "000644"
    owner: root
    group: root
    content: |
      LoadModule ssl_module modules/mod_ssl.so
      Listen 443
      <VirtualHost *:443>
        <Proxy *>
          Order deny,allow
          Allow from all
        </Proxy>

        SSLEngine             on
        SSLCertificateFile    "/etc/pki/tls/certs/server.crt"
        SSLCertificateKeyFile "/etc/pki/tls/certs/server.key"
        SSLCipherSuite        EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH
        SSLProtocol           All -SSLv2 -SSLv3
        SSLHonorCipherOrder   On
        SSLSessionTickets     Off
        
        Header always set Strict-Transport-Security "max-age=63072000; includeSubdomains; preload"
        Header always set X-Frame-Options DENY
        Header always set X-Content-Type-Options nosniff
        
        ProxyPass / http://localhost:80/ retry=0
        ProxyPassReverse / http://localhost:80/
        ProxyPreserveHost on
        RequestHeader set X-Forwarded-Proto "https" early
        
      </VirtualHost>
      
  /etc/pki/tls/certs/server.crt:
    mode: "000400"
    owner: root
    group: root
    content: |
-----BEGIN CERTIFICATE-----
MIIDsjCCApqgAwIBAgIQbDpe1KF/V15EK2eBXs/sCTANBgkqhkiG9w0BAQsFADBz
MQswCQYDVQQGEwJCUjETMBEGA1UECgwKcHJvamVjdGRldjEYMBYGA1UECwwPRGVz
ZW52b2x2aW1lbnRvMQswCQYDVQQIDAJSUzEQMA4GA1UEAwwHQXV0aE9uZTEWMBQG
A1UEBwwNQ2F4aWFzIGRvIFN1bDAeFw0yMjEyMzEwMTE3NDNaFw0zMjEyMzEwMjE4
MDRaMHMxCzAJBgNVBAYTAkJSMRMwEQYDVQQKDApwcm9qZWN0ZGV2MRgwFgYDVQQL
DA9EZXNlbnZvbHZpbWVudG8xCzAJBgNVBAgMAlJTMRAwDgYDVQQDDAdBdXRoT25l
MRYwFAYDVQQHDA1DYXhpYXMgZG8gU3VsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEAt4Evn7xEPAbyssCq5AWp6jymITijYw4ZKMBYleaQViSPIWCBZFQZ
XZvjKU1EbrJIyu5IsIDYDmq6x3bHIYiDnv5erOpHtVfdWvkkHeLAcefR9i0lMNOR
quS1VpD4hM651DFV9CuQAlXuGVnKHj9v9It5SUo2ZxBCNu+jPOI+zpEPT1ta3Yt4
4wNOlMZg3FWUIXTSB93Ux+WeGSiKWdXzHJqMH2SeHLAfU9ls9ALxpFqTMl39TgS8
lwEh9C2wHFBrfK6Rsk3fv/cBxpLuBm++eHDuXqQgTqzR0s61tshcVmJOdp5XaPtW
Cyv0llEwwqaR/50F4A71FjtYcUVvVXsQzQIDAQABo0IwQDAPBgNVHRMBAf8EBTAD
AQH/MB0GA1UdDgQWBBS1YRgUjlWmhbMc9oNL8KAkxQJ3ETAOBgNVHQ8BAf8EBAMC
AYYwDQYJKoZIhvcNAQELBQADggEBABjmJioD+yGH9BGa53zcKBoK1prmNnKzzv67
giUQ0nwqmchs/NgchohCmNN6zi94A8T+brJ7WTOQhbB4wIwL61BlM0IQMmS5yspQ
ypDJN7FrKMMb1pXB30QTl9MCZ6mOfz8QGGlwXtrYAOxelqX9uuyS9qDOGST5MnQG
sm+u6iyjCd39dOSURnsYl7pE+SMJtMYkY3x9a5FGCT3SM+cYPoyHp3AP+GR9M5qL
o/tM+kAlSxyS6U0YPbMR/0y0TyqMgF1BzIomSjP+gZn5BUAYw4pLc6FrS5L4l5Z2
klMojeHQZTN78M8BFVKFtFLbrqosDNAxT0BYgJx0sv2WMo6lXPw=
-----END CERTIFICATE-----
      
  